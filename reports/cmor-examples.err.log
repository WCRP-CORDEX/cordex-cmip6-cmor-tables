Traceback (most recent call last):
  File "/home/runner/micromamba/envs/cordex-examples/lib/python3.9/site-packages/jupyter_core/utils/__init__.py", line 154, in wrapped
    asyncio.get_running_loop()
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/runner/micromamba/envs/cordex-examples/lib/python3.9/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/home/runner/micromamba/envs/cordex-examples/lib/python3.9/site-packages/nbclient/client.py", line 1319, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/home/runner/micromamba/envs/cordex-examples/lib/python3.9/site-packages/jupyter_core/utils/__init__.py", line 158, in wrapped
    return loop.run_until_complete(inner)
  File "/home/runner/micromamba/envs/cordex-examples/lib/python3.9/asyncio/base_events.py", line 647, in run_until_complete
    return future.result()
  File "/home/runner/micromamba/envs/cordex-examples/lib/python3.9/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/home/runner/micromamba/envs/cordex-examples/lib/python3.9/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/runner/micromamba/envs/cordex-examples/lib/python3.9/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
f = test_cmorizer_fx()
------------------

----- stderr -----
Downloading file 'rotated-latitude-longitude.csv' from 'https://raw.githubusercontent.com/WCRP-CORDEX/domain-tables/main/rotated-latitude-longitude.csv' to '/home/runner/.py-cordex'.
----- stderr -----
/home/runner/micromamba/envs/cordex-examples/lib/python3.9/site-packages/cf_xarray/accessor.py:701: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  unused_keys = set(attribute.keys()) - set(inverted)
/home/runner/micromamba/envs/cordex-examples/lib/python3.9/site-packages/cf_xarray/accessor.py:702: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  for key, value in attribute.items():
/home/runner/micromamba/envs/cordex-examples/lib/python3.9/site-packages/cdo/cdo.py:10: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
----- stderr -----
/tmp/ipykernel_3658/3805428128.py:14: DeprecationWarning: 'CORDEX_domain' keyword is deprecated, please use the 'domain_id' keyword instead
  filename = cmor.cmorize_variable(
/home/runner/micromamba/envs/cordex-examples/lib/python3.9/site-packages/cf_xarray/accessor.py:701: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  unused_keys = set(attribute.keys()) - set(inverted)
/home/runner/micromamba/envs/cordex-examples/lib/python3.9/site-packages/cf_xarray/accessor.py:702: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  for key, value in attribute.items():
----- stderr -----
/home/runner/micromamba/envs/cordex-examples/lib/python3.9/site-packages/cordex/cmor/utils.py:334: UserWarning: writing temporary table to /tmp/tmp31pxa32c
  warn(f"writing temporary table to {filename}")

[2;34;47mC Traceback:
In function: cmor_outpath_exist
! called from: cmor_dataset_json
! [0m

[1;34;47m!!!!!!!!!!!!!!!!!!!!!!!!!
!
! Warning: You defined your output directory to be: 'CORDEX', but this
! directory does not exist. CMOR will create it!
!
!!!!!!!!!!!!!!!!!!!!!!!!![0m
----- stderr -----
/home/runner/micromamba/envs/cordex-examples/lib/python3.9/site-packages/cf_xarray/accessor.py:701: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  unused_keys = set(attribute.keys()) - set(inverted)
/home/runner/micromamba/envs/cordex-examples/lib/python3.9/site-packages/cf_xarray/accessor.py:702: FutureWarning: The return type of `Dataset.dims` will be changed to return a set of dimension names in future, in order to be more consistent with `DataArray.dims`. To access a mapping from dimension names to lengths, please use `Dataset.sizes`.
  for key, value in attribute.items():

[2;31;47mC Traceback:
! In function: _CV_checkGblAttributes
! called from: cmor_setGblAttr
! called from: cmor_write
! [0m

[1;31;47m!!!!!!!!!!!!!!!!!!!!!!!!!
!
! Error: Your Controlled Vocabulary file specifies one or more
! required attributes.  The following
! attribute was not properly set.
! 
! Please set attribute: "source" in your input file.
!
!!!!!!!!!!!!!!!!!!!!!!!!![0m


[2;31;47mC Traceback:
! In function: _CV_ValidateAttribute
! called from: _CV_checkGblAttributes
! called from: cmor_setGblAttr
! called from: cmor_write
! [0m

[1;31;47m!!!!!!!!!!!!!!!!!!!!!!!!!
!
! Error: The registered CV attribute "source" has multiple values 
! defined in "../Tables/CORDEX-CMIP6_CV.json"
! Please select one from the entry source_id.REMO2020-2-2.source.
!
!!!!!!!!!!!!!!!!!!!!!!!!![0m


[2;31;47mC Traceback:
! In function: _CV_checkGblAttributes
! called from: cmor_setGblAttr
! called from: cmor_write
! [0m

[1;31;47m!!!!!!!!!!!!!!!!!!!!!!!!!
!
! Error: Please fix required attributes mentioned in
! the warnings/error above and rerun. (aborting!)
! 
!
!!!!!!!!!!!!!!!!!!!!!!!!![0m


[2;31;47mC Traceback:
! In function: [0m

[1;31;47m!!!!!!!!!!!!!!!!!!!!!!!!!
!
! Error: Cannot continue until you fix the errors listed above: -2
!
!!!!!!!!!!!!!!!!!!!!!!!!![0m
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mCMORError[0m                                 Traceback (most recent call last)
Cell [0;32mIn[5], line 1[0m
[0;32m----> 1[0m f [38;5;241m=[39m [43mtest_cmorizer_fx[49m[43m([49m[43m)[49m

Cell [0;32mIn[4], line 14[0m, in [0;36mtest_cmorizer_fx[0;34m()[0m
[1;32m     12[0m [38;5;28;01mdef[39;00m[38;5;250m [39m[38;5;21mtest_cmorizer_fx[39m():
[1;32m     13[0m     ds [38;5;241m=[39m cx[38;5;241m.[39mcordex_domain([38;5;124m"[39m[38;5;124mEUR-11[39m[38;5;124m"[39m, dummy[38;5;241m=[39m[38;5;124m"[39m[38;5;124mtopo[39m[38;5;124m"[39m)
[0;32m---> 14[0m     filename [38;5;241m=[39m [43mcmor[49m[38;5;241;43m.[39;49m[43mcmorize_variable[49m[43m([49m
[1;32m     15[0m [43m        [49m[43mds[49m[43m,[49m
[1;32m     16[0m [43m        [49m[38;5;124;43m"[39;49m[38;5;124;43morog[39;49m[38;5;124;43m"[39;49m[43m,[49m
[1;32m     17[0m [43m        [49m[43mmapping_table[49m[38;5;241;43m=[39;49m[43m{[49m[38;5;124;43m"[39;49m[38;5;124;43morog[39;49m[38;5;124;43m"[39;49m[43m:[49m[43m [49m[43m{[49m[38;5;124;43m"[39;49m[38;5;124;43mvarname[39;49m[38;5;124;43m"[39;49m[43m:[49m[43m [49m[38;5;124;43m"[39;49m[38;5;124;43mtopo[39;49m[38;5;124;43m"[39;49m[43m}[49m[43m}[49m[43m,[49m
[1;32m     18[0m [43m        [49m[43mcmor_table[49m[38;5;241;43m=[39;49m[43mos[49m[38;5;241;43m.[39;49m[43mpath[49m[38;5;241;43m.[39;49m[43mjoin[49m[43m([49m[43mtable_dir[49m[43m,[49m[43m [49m[38;5;124;43m"[39;49m[38;5;124;43mCORDEX-CMIP6_fx.json[39;49m[38;5;124;43m"[39;49m[43m)[49m[43m,[49m
[1;32m     19[0m [43m        [49m[43mdataset_table[49m[38;5;241;43m=[39;49m[43mos[49m[38;5;241;43m.[39;49m[43mpath[49m[38;5;241;43m.[39;49m[43mjoin[49m[43m([49m[43mtable_dir[49m[43m,[49m[43m [49m[38;5;124;43m"[39;49m[38;5;124;43mCORDEX-CMIP6_remo_example.json[39;49m[38;5;124;43m"[39;49m[43m)[49m[43m,[49m
[1;32m     20[0m [43m        [49m[43mgrids_table[49m[38;5;241;43m=[39;49m[43mos[49m[38;5;241;43m.[39;49m[43mpath[49m[38;5;241;43m.[39;49m[43mjoin[49m[43m([49m[43mtable_dir[49m[43m,[49m[43m [49m[38;5;124;43m"[39;49m[38;5;124;43mCORDEX-CMIP6_grids.json[39;49m[38;5;124;43m"[39;49m[43m)[49m[43m,[49m
[1;32m     21[0m [43m        [49m[43mCORDEX_domain[49m[38;5;241;43m=[39;49m[38;5;124;43m"[39;49m[38;5;124;43mEUR-11[39;49m[38;5;124;43m"[39;49m[43m,[49m
[1;32m     22[0m [43m        [49m[43mtime_units[49m[38;5;241;43m=[39;49m[38;5;28;43;01mNone[39;49;00m[43m,[49m
[1;32m     23[0m [43m        [49m[43mallow_units_convert[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m
[1;32m     24[0m [43m    [49m[43m)[49m
[1;32m     25[0m     [38;5;28;01mreturn[39;00m filename

File [0;32m~/micromamba/envs/cordex-examples/lib/python3.9/site-packages/cordex/cmor/cmor.py:829[0m, in [0;36mcmorize_variable[0;34m(ds, out_name, cmor_table, dataset_table, mapping_table, grids_table, inpath, replace_coords, allow_units_convert, allow_resample, input_freq, domain_id, crop, time_units, rewrite_time_axis, outpath, **kwargs)[0m
[1;32m    811[0m     dataset_table[[38;5;124m"[39m[38;5;124moutpath[39m[38;5;124m"[39m] [38;5;241m=[39m outpath
[1;32m    813[0m ds_prep [38;5;241m=[39m prepare_variable(
[1;32m    814[0m     ds,
[1;32m    815[0m     out_name,
[0;32m   (...)[0m
[1;32m    826[0m     [38;5;241m*[39m[38;5;241m*[39mkwargs,
[1;32m    827[0m )
[0;32m--> 829[0m [38;5;28;01mreturn[39;00m [43mcmorize_cmor[49m[43m([49m
[1;32m    830[0m [43m    [49m[43mds_prep[49m[43m,[49m[43m [49m[43mout_name[49m[43m,[49m[43m [49m[43mcmor_table[49m[43m,[49m[43m [49m[43mdataset_table[49m[43m,[49m[43m [49m[43mgrids_table[49m[43m,[49m[43m [49m[43minpath[49m
[1;32m    831[0m [43m[49m[43m)[49m

File [0;32m~/micromamba/envs/cordex-examples/lib/python3.9/site-packages/cordex/cmor/cmor.py:555[0m, in [0;36mcmorize_cmor[0;34m(ds, out_name, cmor_table, dataset_table, grids_table, inpath)[0m
[1;32m    547[0m table_ids [38;5;241m=[39m _setup(
[1;32m    548[0m     dataset_table_json, cmor_table_json, grids_table[38;5;241m=[39mgrids_table, inpath[38;5;241m=[39minpath
[1;32m    549[0m )
[1;32m    551[0m cmorTime, cmorZ, cmorGrid [38;5;241m=[39m _define_axis(
[1;32m    552[0m     ds, table_ids, time_cell_method[38;5;241m=[39mtime_cell_method
[1;32m    553[0m )
[0;32m--> 555[0m [38;5;28;01mreturn[39;00m [43m_cmor_write[49m[43m([49m[43mds[49m[43m[[49m[43mout_name[49m[43m][49m[43m,[49m[43m [49m[43mtable_ids[49m[43m[[49m[38;5;124;43m"[39;49m[38;5;124;43mmip[39;49m[38;5;124;43m"[39;49m[43m][49m[43m,[49m[43m [49m[43mcmorTime[49m[43m,[49m[43m [49m[43mcmorZ[49m[43m,[49m[43m [49m[43mcmorGrid[49m[43m)[49m

File [0;32m~/micromamba/envs/cordex-examples/lib/python3.9/site-packages/cordex/cmor/cmor.py:346[0m, in [0;36m_cmor_write[0;34m(da, table_id, cmorTime, cmorZ, cmorGrid, file_name)[0m
[1;32m    344[0m [38;5;28;01melse[39;00m:
[1;32m    345[0m     ntimes_passed [38;5;241m=[39m [38;5;28;01mNone[39;00m
[0;32m--> 346[0m [43mcmor[49m[38;5;241;43m.[39;49m[43mwrite[49m[43m([49m[43mvar_id[49m[43m,[49m[43m [49m[43mda[49m[38;5;241;43m.[39;49m[43mto_numpy[49m[43m([49m[43m)[49m[43m,[49m[43m [49m[43mntimes_passed[49m[38;5;241;43m=[39;49m[43mntimes_passed[49m[43m)[49m
[1;32m    348[0m [38;5;28;01mreturn[39;00m cmor[38;5;241m.[39mclose(var_id, file_name[38;5;241m=[39mfile_name)

File [0;32m~/micromamba/envs/cordex-examples/lib/python3.9/site-packages/cmor/pywrapper.py:935[0m, in [0;36mwrite[0;34m(var_id, data, ntimes_passed, file_suffix, time_vals, time_bnds, store_with)[0m
[1;32m    931[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m data_type [38;5;129;01min[39;00m [[38;5;124m'[39m[38;5;124mf[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124md[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124mi[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124ml[39m[38;5;124m'[39m]:
[1;32m    932[0m     [38;5;28;01mraise[39;00m [38;5;167;01mException[39;00m(
[1;32m    933[0m         [38;5;124m"[39m[38;5;124mError data data_type must one of: int32, int64, float32, float64. Please convert first[39m[38;5;124m"[39m)
[0;32m--> 935[0m [38;5;28;01mreturn[39;00m [43m_cmor[49m[38;5;241;43m.[39;49m[43mwrite[49m[43m([49m[43mvar_id[49m[43m,[49m[43m [49m[43mdata[49m[43m,[49m[43m [49m[43mdata_type[49m[43m,[49m[43m [49m[43mfile_suffix[49m[43m,[49m[43m [49m[43mntimes_passed[49m[43m,[49m
[1;32m    936[0m [43m                   [49m[43mtime_vals[49m[43m,[49m[43m [49m[43mtime_bnds[49m[43m,[49m[43m [49m[43mstore_with[49m[43m)[49m

[0;31mCMORError[0m: Problem with 'cmor.write'. Please check the logfile (if defined).

