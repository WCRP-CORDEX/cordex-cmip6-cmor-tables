Traceback (most recent call last):
  File "/home/runner/micromamba-root/envs/cordex-examples/lib/python3.8/site-packages/jupyter_cache/executors/utils.py", line 51, in single_nb_execution
    executenb(
  File "/home/runner/micromamba-root/envs/cordex-examples/lib/python3.8/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/home/runner/micromamba-root/envs/cordex-examples/lib/python3.8/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/home/runner/micromamba-root/envs/cordex-examples/lib/python3.8/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/home/runner/micromamba-root/envs/cordex-examples/lib/python3.8/asyncio/base_events.py", line 616, in run_until_complete
    return future.result()
  File "/home/runner/micromamba-root/envs/cordex-examples/lib/python3.8/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/home/runner/micromamba-root/envs/cordex-examples/lib/python3.8/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/runner/micromamba-root/envs/cordex-examples/lib/python3.8/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
f = test_cmorizer_fx()
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mCMORError[0m                                 Traceback (most recent call last)
Cell [0;32mIn[5], line 1[0m
[0;32m----> 1[0m f [38;5;241m=[39m [43mtest_cmorizer_fx[49m[43m([49m[43m)[49m

Cell [0;32mIn[4], line 14[0m, in [0;36mtest_cmorizer_fx[0;34m()[0m
[1;32m     12[0m [38;5;28;01mdef[39;00m [38;5;21mtest_cmorizer_fx[39m():
[1;32m     13[0m     ds [38;5;241m=[39m cx[38;5;241m.[39mcordex_domain([38;5;124m"[39m[38;5;124mEUR-11[39m[38;5;124m"[39m, dummy[38;5;241m=[39m[38;5;124m"[39m[38;5;124mtopo[39m[38;5;124m"[39m)
[0;32m---> 14[0m     filename [38;5;241m=[39m [43mcmor[49m[38;5;241;43m.[39;49m[43mcmorize_variable[49m[43m([49m
[1;32m     15[0m [43m        [49m[43mds[49m[43m,[49m
[1;32m     16[0m [43m        [49m[38;5;124;43m"[39;49m[38;5;124;43morog[39;49m[38;5;124;43m"[39;49m[43m,[49m
[1;32m     17[0m [43m        [49m[43mmapping_table[49m[38;5;241;43m=[39;49m[43m{[49m[38;5;124;43m"[39;49m[38;5;124;43morog[39;49m[38;5;124;43m"[39;49m[43m:[49m[43m [49m[43m{[49m[38;5;124;43m"[39;49m[38;5;124;43mvarname[39;49m[38;5;124;43m"[39;49m[43m:[49m[43m [49m[38;5;124;43m"[39;49m[38;5;124;43mtopo[39;49m[38;5;124;43m"[39;49m[43m}[49m[43m}[49m[43m,[49m
[1;32m     18[0m [43m        [49m[43mcmor_table[49m[38;5;241;43m=[39;49m[43mos[49m[38;5;241;43m.[39;49m[43mpath[49m[38;5;241;43m.[39;49m[43mjoin[49m[43m([49m[43mtable_dir[49m[43m,[49m[43m [49m[38;5;124;43m"[39;49m[38;5;124;43mCORDEX_fx.json[39;49m[38;5;124;43m"[39;49m[43m)[49m[43m,[49m
[1;32m     19[0m [43m        [49m[43mdataset_table[49m[38;5;241;43m=[39;49m[43mos[49m[38;5;241;43m.[39;49m[43mpath[49m[38;5;241;43m.[39;49m[43mjoin[49m[43m([49m[43mtable_dir[49m[43m,[49m[43m [49m[38;5;124;43m"[39;49m[38;5;124;43mCORDEX_remo_example.json[39;49m[38;5;124;43m"[39;49m[43m)[49m[43m,[49m
[1;32m     20[0m [43m        [49m[43mgrids_table[49m[38;5;241;43m=[39;49m[43mos[49m[38;5;241;43m.[39;49m[43mpath[49m[38;5;241;43m.[39;49m[43mjoin[49m[43m([49m[43mtable_dir[49m[43m,[49m[43m [49m[38;5;124;43m"[39;49m[38;5;124;43mCORDEX_grids.json[39;49m[38;5;124;43m"[39;49m[43m)[49m[43m,[49m
[1;32m     21[0m [43m        [49m[43mCORDEX_domain[49m[38;5;241;43m=[39;49m[38;5;124;43m"[39;49m[38;5;124;43mEUR-11[39;49m[38;5;124;43m"[39;49m[43m,[49m
[1;32m     22[0m [43m        [49m[43mtime_units[49m[38;5;241;43m=[39;49m[38;5;28;43;01mNone[39;49;00m[43m,[49m
[1;32m     23[0m [43m        [49m[43mallow_units_convert[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m
[1;32m     24[0m [43m    [49m[43m)[49m
[1;32m     25[0m     [38;5;28;01mreturn[39;00m filename

File [0;32m~/micromamba-root/envs/cordex-examples/lib/python3.8/site-packages/cordex/cmor/cmor.py:494[0m, in [0;36mcmorize_variable[0;34m(ds, out_name, cmor_table, dataset_table, mapping_table, grids_table, inpath, allow_units_convert, allow_resample, input_freq, CORDEX_domain, vertices, time_units, **kwargs)[0m
[1;32m    489[0m time_cell_method [38;5;241m=[39m _strip_time_cell_method(cfvarinfo)
[1;32m    490[0m cmorTime, cmorGrid [38;5;241m=[39m _define_grid(
[1;32m    491[0m     ds_prep, table_ids, time_cell_method[38;5;241m=[39mtime_cell_method
[1;32m    492[0m )
[0;32m--> 494[0m [38;5;28;01mreturn[39;00m [43m_cmor_write[49m[43m([49m[43mds_prep[49m[43m[[49m[43mout_name[49m[43m][49m[43m,[49m[43m [49m[43mtable_ids[49m[43m[[49m[38;5;241;43m1[39;49m[43m][49m[43m,[49m[43m [49m[43mcmorTime[49m[43m,[49m[43m [49m[43mcmorGrid[49m[43m)[49m

File [0;32m~/micromamba-root/envs/cordex-examples/lib/python3.8/site-packages/cordex/cmor/cmor.py:264[0m, in [0;36m_cmor_write[0;34m(da, table_id, cmorTime, cmorGrid, file_name)[0m
[1;32m    262[0m     coords [38;5;241m=[39m [cmorTime, cmorGrid]
[1;32m    263[0m cmor_var [38;5;241m=[39m cmor[38;5;241m.[39mvariable(da[38;5;241m.[39mname, da[38;5;241m.[39munits, coords)
[0;32m--> 264[0m [43mcmor[49m[38;5;241;43m.[39;49m[43mwrite[49m[43m([49m[43mcmor_var[49m[43m,[49m[43m [49m[43mda[49m[38;5;241;43m.[39;49m[43mvalues[49m[43m)[49m
[1;32m    265[0m [38;5;28;01mreturn[39;00m cmor[38;5;241m.[39mclose(cmor_var, file_name[38;5;241m=[39mfile_name)

File [0;32m~/micromamba-root/envs/cordex-examples/lib/python3.8/site-packages/cmor/pywrapper.py:843[0m, in [0;36mwrite[0;34m(var_id, data, ntimes_passed, file_suffix, time_vals, time_bnds, store_with)[0m
[1;32m    839[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m data_type [38;5;129;01min[39;00m [[38;5;124m'[39m[38;5;124mf[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124md[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124mi[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124ml[39m[38;5;124m'[39m]:
[1;32m    840[0m     [38;5;28;01mraise[39;00m [38;5;167;01mException[39;00m(
[1;32m    841[0m         [38;5;124m"[39m[38;5;124mError data data_type must one of: int32, int64, float32, float64. Please convert first[39m[38;5;124m"[39m)
[0;32m--> 843[0m [38;5;28;01mreturn[39;00m [43m_cmor[49m[38;5;241;43m.[39;49m[43mwrite[49m[43m([49m[43mvar_id[49m[43m,[49m[43m [49m[43mdata[49m[43m,[49m[43m [49m[43mdata_type[49m[43m,[49m[43m [49m[43mfile_suffix[49m[43m,[49m[43m [49m[43mntimes_passed[49m[43m,[49m
[1;32m    844[0m [43m                   [49m[43mtime_vals[49m[43m,[49m[43m [49m[43mtime_bnds[49m[43m,[49m[43m [49m[43mstore_with[49m[43m)[49m

[0;31mCMORError[0m: Problem with 'cmor.write'. Please check the logfile (if defined).
CMORError: Problem with 'cmor.write'. Please check the logfile (if defined).

